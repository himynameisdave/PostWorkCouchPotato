define("../js/modules/watchedVideos.js",[],function(){return{videos:[],init:function(){var e=localStorage.getItem("watchedVideos");null!==e&&(e=JSON.parse(e),this.videos=e.videos)},addNewWatchedVideo:function(e){this.videos.push(e),this.updateWatchedVideos()},updateWatchedVideos:function(){var e={videos:this.videos};localStorage.setItem("watchedVideos",JSON.stringify(e))},pruneOldVideos:function(){var e=[],t=Date.now()/1e3,i=604800;this.videos.forEach(function(o){t-o.time<i&&e.push(o)}),this.videos=e,this.updateWatchedVideos()},returnLastFetched:function(){return this.videos.slice(-1)[0]},returnSimpleWatchedList:function(){return this.videos.map(function(e){return e.data.name})}}}),define("../js/modules/freshVideos.js",[],function(){return{videos:[],lastFetched:!1,fetchVideos:function(e){var t="https://www.reddit.com/r/videos/.json?count=25";this.lastFetched&&(t+="&after="+this.lastFetched),console.log("Fetching, using this url: ",t);var i=new XMLHttpRequest,o=this;i.open("get",t,!0),i.onload=function(t){var d=JSON.parse(i.response).data.children;console.log("Fetching data, using this to set lastFetched: ",d[d.length-1]),o.lastFetched=d[d.length-1].data.name,e(d)},i.send()},addNewFreshVideo:function(e){this.videos.unshift(e)}}}),define("../js/modules/currentVideo.js",[],function(){return{video:{},foundLocalCurrentVid:!1,init:function(){var e=localStorage.getItem("currentVideo");null!==e?(this.foundLocalCurrentVid=!0,e=JSON.parse(e),this.video=e.video):this.foundLocalCurrentVid=!1},changeCurrentVideo:function(e){this.video=e;var t={video:e};localStorage.setItem("currentVideo",JSON.stringify(t))},returnCurrentVideoName:function(){return this.video.data.name},getMediaEmbedData:function(){return this.video.data.media_embed.content.replace("&lt;","<").replace("&lt;","<").replace("&gt;",">").replace("&gt;",">")}}}),define("../js/modules/dom.js",[],function(){return{els:{vidTitle:document.querySelector(".video-title"),vidNextBtn:document.querySelector(".video-button.button-next"),vidPrevBtn:document.querySelector(".video-button.button-prev"),vidBox:document.querySelector(".video-container")},unescapeHtml:function(e){var t=document.createElement("div");t.innerHTML=e;var i=t.childNodes[0].nodeValue;return t.removeChild(t.firstChild),i},emptyElement:function(e){e.innerHTML=""},displayVideo:function(e){var t=e.data.media_embed.content.replace("&lt;","<").replace("&lt;","<").replace("&gt;",">").replace("&gt;",">");this.els.vidBox.innerHTML=t,this.els.vidTitle.innerHTML=e.data.title}}}),define("main",["require","../js/modules/watchedVideos.js","../js/modules/freshVideos.js","../js/modules/currentVideo.js","../js/modules/dom.js"],function(e){var t=e("../js/modules/watchedVideos.js"),i=e("../js/modules/freshVideos.js"),o=e("../js/modules/currentVideo.js"),d=e("../js/modules/dom.js"),n=function(e){i.fetchVideos(function(o){var d=t.returnSimpleWatchedList(),n=o.filter(function(e){return"moderator"!==e.data.distinguished&&"self.videos"!==e.data.domain&&e.data.media_embed.content?d.indexOf(e.data.name)>-1?!1:e:!1});i.videos=n,e&&e()},t.returnLastFetched())},s=function(){d.els.vidNextBtn.onclick=function(e){t.addNewWatchedVideo(o.video),o.changeCurrentVideo(i.videos[0]),i.videos.shift(),d.displayVideo(o.video),0===i.videos.length&&(console.info("FreshVideos.videos.length is 0,",i),n())},d.els.vidPrevBtn.onclick=function(e){if(t.videos.length<=0)return alert("No previous videos to check out!");i.addNewFreshVideo(o.video);var n=t.videos.length;o.changeCurrentVideo(t.videos[n-1]),t.videos.pop(),d.displayVideo(o.video)}};t.init(),o.init(),o.foundLocalCurrentVid&&(console.log("found a CurrentVideo"),d.displayVideo(o.video)),n(function(){o.foundLocalCurrentVid||(o.changeCurrentVideo(i.videos[0]),i.videos.shift(),d.displayVideo(o.video)),s()})});